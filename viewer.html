<!DOCTYPE html>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.7.3.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.7.3.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.7.3.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.7.3.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.7.3.min.js"></script>
<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-api-3.7.3.min.js"></script>
<script type="module">
  import * as zarr from "https://cdn.jsdelivr.net/npm/zarrita/+esm";
  const store = new zarr.FetchStore("https://thevro.github.io/zarr_test/A01_ethene.zarr/");
  const root = zarr.root(store);
  const energy = await zarr.open.v3(root.resolve("energy"), { kind: "array" });
  const energy_region = await zarr.get(energy, [0, zarr.slice(43180)]);

  const time = await zarr.open.v3(root.resolve("time"), { kind: "array" });
  const time_chunk = await time.getChunk([0]);

  const atraj = await zarr.open.v3(root.resolve("atrajectory"), { kind: "array" });
  const atraj_chunk = await atraj.getChunk([0]);

  const source = new Bokeh.ColumnDataSource({ data: {energy: energy_region.data, time: time_chunk.data} });
  const plot = Bokeh.Plotting.figure({});
  plot.scatter(
    { field: 'time' },
    { field: 'energy' },
    { source: source, selection_color: 'red' }
  );
  Bokeh.Plotting.show(plot);
</script>